// Generated by CoffeeScript 1.12.7
(function() {
  var BaseClass, SourceLineColumnMap, defineModule,
    extend = function(child, parent) { for (var key in parent) { if (hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; },
    hasProp = {}.hasOwnProperty;

  BaseClass = require('art-class-system').BaseClass;

  defineModule = require('art-standard-lib').defineModule;

  defineModule(module, SourceLineColumnMap = (function(superClass) {
    extend(SourceLineColumnMap, superClass);

    function SourceLineColumnMap(_source) {
      var count, k, len, line, ref;
      this._source = _source;
      count = 0;
      this._lineOffsets = [];
      ref = this._source.split("\n");
      for (k = 0, len = ref.length; k < len; k++) {
        line = ref[k];
        this._lineOffsets.push(count);
        count += line.length + 1;
      }
      null;
    }

    SourceLineColumnMap.getter("source");

    SourceLineColumnMap.prototype.getLineColumn = function(offset, into) {
      var column, i, j, line, lineOffsets, m;
      lineOffsets = this._lineOffsets;
      i = 0;
      j = lineOffsets.length - 1;
      while (i < j) {
        if (i === j - 1) {
          if (lineOffsets[j] <= offset) {
            i = j;
          } else {
            j = i;
          }
        } else {
          m = (i + j) / 2 | 0;
          if (lineOffsets[m] > offset) {
            j = m;
          } else {
            i = m;
          }
        }
      }
      column = offset - lineOffsets[line = i];
      if (into) {
        into.column = column;
        into.line = line;
        return into;
      } else {
        return {
          column: column,
          line: line
        };
      }
    };

    SourceLineColumnMap.prototype.getIndex = function(line, column) {
      return this._lineOffsets[line] + column;
    };

    return SourceLineColumnMap;

  })(BaseClass));

}).call(this);

//# sourceMappingURL=SourceLineColumnMap.js.map
